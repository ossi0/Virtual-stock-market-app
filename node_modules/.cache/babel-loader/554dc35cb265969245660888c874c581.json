{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\pexi8\\\\Desktop\\\\weather\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\pexi8\\\\Desktop\\\\weather\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:\\\\Users\\\\pexi8\\\\Desktop\\\\weather\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\pexi8\\\\Desktop\\\\weather\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\pexi8\\\\Desktop\\\\weather\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{returnStations,showData}from\"../index\";import Metolib from\"@fmidev/metolib\";var Searchbar=/*#__PURE__*/function(_Component){_inherits(Searchbar,_Component);var _super=_createSuper(Searchbar);function Searchbar(props){var _this;_classCallCheck(this,Searchbar);_this=_super.call(this,props);_this.handleDropdownVisibility=function(state){_this.setState({visible:state===0?false:true});};_this.handleDropdownSearch=function(event){_this.setState({value:event.target.value});};_this.handleOptionClick=function(id){// Määritellään ensiksi tämänhetkinen aika (dt) sekä aika vuosi sitten (dtstart)\nvar dt=new Date();var dtstart=new Date(new Date().getFullYear()-1,new Date().getMonth(),new Date().getDate());var parser=new Metolib.WfsRequestParser();var SERVER_URL=\"http://opendata.fmi.fi/wfs\";var STORED_QUERY_OBSERVATION=\"fmi::observations::weather::daily::multipointcoverage\";parser.getData({url:SERVER_URL,storedQueryId:STORED_QUERY_OBSERVATION,requestParameter:\"tmin,tmax\",begin:new Date(dtstart).getTime(),end:new Date(dt).getTime(),fmisid:id,callback:function callback(data,errors){console.log(data);showData(data);if(errors){// Miten tämä toimii??\nconsole.log(\"Virhe\");}}});};_this.state={visible:false,value:\"\"};_this.handleDropdownSearch=_this.handleDropdownSearch.bind(_assertThisInitialized(_this));return _this;}_createClass(Searchbar,[{key:\"render\",value:function render(){var _this2=this;var option=function option(name,key){return React.createElement(\"a\",{style:{cursor:\"pointer\"},// href: key,\nkey:key,onMouseDown:function onMouseDown(){_this2.handleOptionClick(key);}},name);};var fetchOptions=function fetchOptions(){var optionlist=[];returnStations(_this2.state.value).forEach(function(value,index){optionlist.push(option(value[0],value[1]));});return optionlist;};var dropdownVisibleClass=\"dropdown-content\";var dropdownHiddenClass=\"dropdown-content hidden\";return/*#__PURE__*/React.createElement(\"div\",{id:\"search\",className:\"card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-header justify-content-center \"},\"Valitse haluamasi mittausasema havaintohistoriaa varten\"),/*#__PURE__*/React.createElement(\"div\",{className:\"card-body justify-content-center\",onFocus:function onFocus(){return _this2.handleDropdownVisibility(1);},onBlur:function onBlur(){return _this2.handleDropdownVisibility(0);}},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",value:this.state.value,placeholder:\"Hae...\",id:\"dropdowninput\",onChange:this.handleDropdownSearch}),/*#__PURE__*/React.createElement(\"div\",{className:\"dropdown\"},/*#__PURE__*/React.createElement(\"div\",{id:\"dropdownbox\",className:this.state.visible===true?dropdownVisibleClass:dropdownHiddenClass},fetchOptions()))));}}]);return Searchbar;}(Component);export default Searchbar;","map":{"version":3,"sources":["C:/Users/pexi8/Desktop/weather/src/components/searchbar.jsx"],"names":["React","Component","returnStations","showData","Metolib","Searchbar","props","handleDropdownVisibility","state","setState","visible","handleDropdownSearch","event","value","target","handleOptionClick","id","dt","Date","dtstart","getFullYear","getMonth","getDate","parser","WfsRequestParser","SERVER_URL","STORED_QUERY_OBSERVATION","getData","url","storedQueryId","requestParameter","begin","getTime","end","fmisid","callback","data","errors","console","log","bind","option","name","key","createElement","style","cursor","onMouseDown","fetchOptions","optionlist","forEach","index","push","dropdownVisibleClass","dropdownHiddenClass"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { returnStations, showData } from \"../index\";\r\nimport Metolib from \"@fmidev/metolib\";\r\n\r\nclass Searchbar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      visible: false,\r\n      value: \"\",\r\n    };\r\n\r\n    this.handleDropdownSearch = this.handleDropdownSearch.bind(this);\r\n  }\r\n\r\n  handleDropdownVisibility = (state) => {\r\n    this.setState({ visible: state === 0 ? false : true });\r\n  };\r\n  handleDropdownSearch = (event) => {\r\n    this.setState({ value: event.target.value });\r\n  };\r\n  // Tekee datapyynnön fmi:ltä ja kutsuu datankäsittelijäfunktion showData (index.js)\r\n  handleOptionClick = (id) => {\r\n    // Määritellään ensiksi tämänhetkinen aika (dt) sekä aika vuosi sitten (dtstart)\r\n    var dt = new Date();\r\n    var dtstart = new Date(\r\n      new Date().getFullYear() - 1,\r\n      new Date().getMonth(),\r\n      new Date().getDate()\r\n    );\r\n    var parser = new Metolib.WfsRequestParser();\r\n    var SERVER_URL = \"http://opendata.fmi.fi/wfs\";\r\n    var STORED_QUERY_OBSERVATION =\r\n      \"fmi::observations::weather::daily::multipointcoverage\";\r\n    parser.getData({\r\n      url: SERVER_URL,\r\n      storedQueryId: STORED_QUERY_OBSERVATION,\r\n      requestParameter: \"tmin,tmax\",\r\n      begin: new Date(dtstart).getTime(),\r\n      end: new Date(dt).getTime(),\r\n      fmisid: id,\r\n      callback: function (data, errors) {\r\n        console.log(data);\r\n        showData(data);\r\n        if (errors) {\r\n          // Miten tämä toimii??\r\n          console.log(\"Virhe\");\r\n        }\r\n      },\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const option = (name, key) =>\r\n      React.createElement(\r\n        \"a\",\r\n        {\r\n          style: {\r\n            cursor: \"pointer\",\r\n          },\r\n          // href: key,\r\n          key: key,\r\n          onMouseDown: () => {\r\n            this.handleOptionClick(key);\r\n          },\r\n        },\r\n        name\r\n      );\r\n    const fetchOptions = () => {\r\n      var optionlist = [];\r\n      returnStations(this.state.value).forEach((value, index) => {\r\n        optionlist.push(option(value[0], value[1]));\r\n      });\r\n      return optionlist;\r\n    };\r\n    const dropdownVisibleClass = \"dropdown-content\";\r\n    const dropdownHiddenClass = \"dropdown-content hidden\";\r\n    return (\r\n      <div id=\"search\" className=\"card\">\r\n        <div className=\"card-header justify-content-center \">\r\n          Valitse haluamasi mittausasema havaintohistoriaa varten\r\n        </div>\r\n        <div\r\n          className=\"card-body justify-content-center\"\r\n          onFocus={() => this.handleDropdownVisibility(1)}\r\n          onBlur={() => this.handleDropdownVisibility(0)}\r\n        >\r\n          <input\r\n            type=\"text\"\r\n            value={this.state.value}\r\n            placeholder=\"Hae...\"\r\n            id=\"dropdowninput\"\r\n            onChange={this.handleDropdownSearch}\r\n          />\r\n          <div className=\"dropdown\">\r\n            <div\r\n              id=\"dropdownbox\"\r\n              className={\r\n                this.state.visible === true\r\n                  ? dropdownVisibleClass\r\n                  : dropdownHiddenClass\r\n              }\r\n            >\r\n              {fetchOptions()}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Searchbar;\r\n"]},"metadata":{},"sourceType":"module"}